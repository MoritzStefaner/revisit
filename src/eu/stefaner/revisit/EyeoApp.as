package eu.stefaner.revisit {	import flare.util.Strings;	import flash.events.Event;	import flash.net.FileReference;	import flash.net.URLLoader;	import flash.net.URLRequest;	/**	 * @author mo	 */	public class EyeoApp extends App {		private static const SAVE_SELECTED : Boolean = false;		private var loader : URLLoader;		public function EyeoApp() {			App.appMode = REPLAY;			Settings.maxItems = 400;			Settings.searchterms = ["eyeo", "@eyeofestival"];			Settings.appTitle = "#eyeo";			super();			TweetSprite.baseScale = .66;			Settings.baseScaleGrow = Settings.baseScaleShrink = 0;		}		override protected function loadData() : void {			if (!loader) {				loader = new URLLoader();				// loader.load(new URLRequest("data/eyeotweets.txt"));				loader.load(new URLRequest("data/eyeotweets_400.txt"));				loader.addEventListener(Event.COMPLETE, onDataLoaded);			} else {				searchMode = App.LIVEUPDATES;				resetAdvanceTimer();			}		}		private function onDataLoaded(event : Event) : void {			var s : String = event.target.data;			var a : Array = s.split("\-\n");			trace(a.length + " tweets loaded", "");			/*			author=creativeapps			id=tag:search.twitter.com,2005:83929594540982272			published=2011-06-23 16:09:09 			source=twitter			title=@moritz_stefaner I'd love to but plane tickets are just too expensive... / have a great time! - Dave is a fantastic host /cc @eyeofestival			url=http://twitter.com/creativeapps/statuses/83929594540982272			 */			var results : Array = [];			var td : TweetData;			displayStatus(results.length + " tweets loaded");			var tweets : Array = [];			for each (var l:String in a) {				try {					var o : * = {};					var aa : Array = l.split("\n");					for each (var l2:String in aa) {						var aaa : Array = l2.split("=");						o[aaa.shift()] = aaa.join("=");					}					var td : TweetData = new TweetData();					td.id = o.id;					td.link = o.url || "";					td.text = o.title || "";					td.createdAt = o.published;										td.user = o.author;					td.userLink = o.author;					td.userName = o.author;					if (td.date.date < 26 || td.date.date > 30 ) continue;					tweets.push(td);					td.props.originalDataString = l;					td.userProfileImage = Strings.format("http://api.twitter.com/1/users/profile_image/{0}?size=bigger", o.author);				} catch(error : Error) {				}				// trace(o.title);			}			tweets.sortOn("dateTime", Array.NUMERIC);			for each (var td:TweetData in tweets) {				visualization.addTweetSprite(td, true);			}			var output : String = "";			if (SAVE_SELECTED) {				visualization.checkForTooManyTweets(ts);				for each (var ts:TweetSprite in visualization.data.nodes) {					output += ts.data.props.originalDataString + "\n-\n";				}				new FileReference().save(output, "eyeotweets_" + Settings.maxItems + ".txt");			}			// searchMode = App.LIVEUPDATES;			resetAdvanceTimer();		}	}}